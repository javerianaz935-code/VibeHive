<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VibeHive | Contact Us</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    
    <link rel="stylesheet" href="contact.css"> 
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

    <header class="header-vibe">
        <div class="container d-flex justify-content-between align-items-center">
            <div class="logo-area h4 mb-0">
                <img src="images/logo.png" alt="VibeHive Logo"  style="height:50px; width:auto; object-fit:contain;"> 
            </div>
            <nav class="d-none d-md-flex align-items-center">
                <a class="nav-link text-white mx-2" href="index.html">Home</a>
                <a class="nav-link text-white mx-2" href="product.html">Product</a>
                <a class="nav-link text-white mx-2" href="about.html">About</a>
                <a class="nav-link text-white mx-2 active" href="contact.html">Contact</a>
            </nav>
            <div class="d-flex align-items-center">
                <a href="wishlist.html" class="text-white mx-2"><i class="fas fa-heart"></i></a>
                <a href="checkout.html" class="text-white mx-2 cart-icon-container">
                    <i class="fas fa-shopping-cart" id="cart-icon"></i>
                    <span id="cart-badge" class="cart-badge">0</span>
                </a>
                <a href="login.html" id="profile-link" class="text-white mx-2"><i class="fas fa-user-circle"></i></a>
            </div>
        </div>
    </header>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const profileLink = document.getElementById('profile-link');
            const loggedInCustomer = JSON.parse(localStorage.getItem('loggedInCustomer'));

            // üß≠ If customer logged in ‚Üí profile page; otherwise ‚Üí login
            if (loggedInCustomer) {
                profileLink.setAttribute('href', 'customer_profile.html');
            } else {
                profileLink.setAttribute('href', 'login.html');
            }
        });
    </script>

    <main class="container py-5">
        <div class="card p-5">
            <h1 class="text-center text-primary mb-5">Contact Us</h1>
            
            <div class="row">
                
                <div class="col-lg-6 mb-4">
                    <h2 class="h5 text-highlight mb-3">Send Us a Message</h2>
                    <form id="contact-form">
                        <div class="form-group">
                            <label for="contact-name">Name</label>
                            <input type="text" class="form-control" id="contact-name" required placeholder="Your Name">
                        </div>
                        <div class="form-group">
                            <label for="contact-email">Email</label>
                            <input type="email" class="form-control" id="contact-email" required placeholder="Your Email">
                        </div>
                        <div class="form-group">
                            <label for="contact-subject">Subject</label>
                            <input type="text" class="form-control" id="contact-subject" required placeholder="Message Subject">
                        </div>
                        <div class="form-group">
                            <label for="contact-message">Message</label>
                            <textarea class="form-control" id="contact-message" rows="4" required placeholder="Type your message here..."></textarea>
                        </div>
                        
                        <button type="submit" class="btn btn-primary-vibe mt-3" style="background-color: var(--color-primary); color: white;">
                            <i class="fas fa-paper-plane mr-2"></i> Send
                        </button>
                    </form>
                </div>

                <div class="col-lg-6 mb-4">
                    <h2 class="h5 text-highlight mb-3">Contact Information</h2>
                    
                    <ul class="list-unstyled contact-info">
                        <li class="mb-3">
                            <i class="fas fa-map-marker-alt fa-lg text-primary mr-3"></i>
                            <div>
                                <strong class="text-primary">Our Address:</strong><br>
                                Anarkali Bazar, Bahawalnagar, Pakistan
                            </div>
                        </li>
                        <li class="mb-3">
                            <i class="fas fa-phone fa-lg text-primary mr-3"></i>
                            <div>
                                <strong class="text-primary">Call Us:</strong><br>
                                +92 42 111 647 428
                            </div>
                        </li>
                        <li class="mb-3">
                            <i class="fas fa-envelope fa-lg text-primary mr-3"></i>
                            <div>
                                <strong class="text-primary">Email Us:</strong><br>
                                awaiswattu@mail.com
                            </div>
                        </li>
                    </ul>

                    <hr class="my-4">

                    <h2 class="h5 text-highlight mb-3">Social Media</h2>
                    <a href="#" class="btn btn-primary-vibe mr-2" style="background-color: #3b5998; color: white;"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="btn btn-primary-vibe mr-2" style="background-color: #00acee; color: white;"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="btn btn-primary-vibe" style="background-color: #E1306C; color: white;"><i class="fab fa-instagram"></i></a>
                </div>

            </div>
        </div>
    </main>

    <div id="toast-notification" class="fixed-top alert d-none" style="top: 80px; right: 20px; width: 300px; z-index: 1000;">
        <i class="mr-2 fas"></i> <span></span>
    </div>

    <div id="chatbot-modal" class="chatbot-modal"> <div class="chatbot-header">
            <span>AI Chatbot</span>
            <i class="fas fa-times chatbot-close" onclick="toggleChatbot()"></i> 
        </div>
        <div class="chatbot-body">
            <div class="text-muted mb-2">Hello! How can I assist you?</div>
            
        </div>
        <div class="chatbot-input-area">
            <input type="text" placeholder="Type a message..." id="chatbot-input">
            <button onclick="simulateChatResponse()"><i class="fas fa-paper-plane"></i> Send</button>
        </div>
    </div>

    <div id="chatbot-icon" class="chatbot-float-icon" onclick="toggleChatbot()">
        <i class="fas fa-comment-dots"></i>
    </div>
    
    <footer class="footer-vibe mt-5">
        <div class="container py-4">
             </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <script src="contact.js"></script>

    <script>
        async function sendMessageToChatbot(message) {
            const loggedInCustomer = JSON.parse(localStorage.getItem("loggedInCustomer"));
            const customerId = loggedInCustomer ? loggedInCustomer.id : null;

            const response = await fetch("http://127.0.0.1:5000/chat", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ message: userMessage, customer_id: customerId })
            });
        }

        async function simulateChatResponse() {
            const input = document.getElementById('chatbot-input');
            const userMessage = input.value.trim();
            if (!userMessage) return;

            const chatbotBody = document.querySelector('.chatbot-body');

            // --- User message ---
            const userDiv = document.createElement('div');
            userDiv.classList.add('user-message');
            userDiv.textContent = userMessage;
            chatbotBody.appendChild(userDiv);

            input.value = "";

            // --- Bot typing indicator ---
            const loadingDiv = document.createElement('div');
            loadingDiv.classList.add('bot-message');
            loadingDiv.textContent = "Typing...";
            chatbotBody.appendChild(loadingDiv);
            chatbotBody.scrollTop = chatbotBody.scrollHeight;

            try {
                // ‚úÖ Send message to Flask (with or without customer_id)
                const loggedInCustomer = JSON.parse(localStorage.getItem("loggedInCustomer"));
                const customerId = loggedInCustomer ? loggedInCustomer.id : null;

                const response = await fetch("http://127.0.0.1:5000/chat", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        message: userMessage,
                        customer_id: customerId
                    })
                });

                const data = await response.json();

                // --- Replace loading text with chatbot reply ---
                loadingDiv.innerHTML = data.reply;  // ‚úÖ innerHTML to render links properly
            } catch (error) {
                loadingDiv.textContent = "‚ö†Ô∏è Sorry, I couldn‚Äôt connect to the server.";
                console.error("Chatbot error:", error);
            }

            chatbotBody.scrollTop = chatbotBody.scrollHeight;
        }

    </script>

</body>
</html>