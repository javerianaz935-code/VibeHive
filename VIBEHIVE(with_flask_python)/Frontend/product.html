<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VibeHive | Shop All Products</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <link rel="stylesheet" href="product.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>

    <header class="header-vibe">
        <div class="container d-flex justify-content-between align-items-center">

            <div class="logo-area h4 mb-0">
                <img src="images/logo.png" alt="VibeHive Logo" style="height:50px; width:auto; object-fit:contain;">
            </div>

            <!-- this code is for nav bar categories show on product drop down -->
            <nav class="d-none d-md-flex align-items-center">
                <a class="nav-link text-white mx-2" href="index.html">Home</a>

                <!-- PRODUCT DROPDOWN -->
                <div class="nav-item dropdown mx-2">
                    <a class="nav-link dropdown-toggle text-white" href="#" id="productDropdown" role="button"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Products
                    </a>

                    <div class="dropdown-menu p-3" id="navbar-category-list"
                        style="min-width: 260px; max-height: 400px; overflow-y: auto;">
                        <!-- Categories load here -->
                        <span class="text-muted small">Loading...</span>
                    </div>
                </div>

                <a class="nav-link text-white mx-2" href="about.html">About</a>
                <a class="nav-link text-white mx-2" href="contact.html">Contact</a>
            </nav>


            <div class="d-flex align-items-center">
                <div class="search-box mx-3 d-flex align-items-center">
                    <!-- search -->
                    <input type="text" id="productSearch" placeholder="Search products..." autocomplete="off" />

                    <div id="searchResults" class="position-absolute bg-white shadow p-3"
                        style="top:45px; width:320px; display:none; z-index:999;">
                    </div>

                    <button class="btn btn-sm btn-link">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
                <a href="wishlist.html" class="text-white mx-2"><i class="fas fa-heart"></i></a>
                <a href="checkout.html" class="text-white mx-2 cart-icon-container">
                    <i class="fas fa-shopping-cart" id="cart-icon"></i>
                    <span id="cart-badge" class="cart-badge">0</span>
                </a>
                <a href="login.html" class="text-white mx-2"><i class="fas fa-user-circle"></i></a>
            </div>
        </div>
    </header>

    <main class="container py-5">
        <h1 class="text-center mb-5">Our Collection</h1>

        <div class="row">

            <div class="col-lg-3 mb-4">
                <div class="card p-4 sticky-top" style="top: 20px;">
                    <h2 class="h5 mb-4 text-primary">Filter By</h2>

                    <div class="mb-4">
                        <h6 class="text-primary font-weight-bold">Category</h6>
                        <ul class="list-unstyled small" id="category-list">
                            <!-- Categories will load dynamically here -->
                        </ul>
                    </div>


                    <div class="mb-4">
                        <h6 class="text-primary font-weight-bold">Price</h6>
                        <ul class="list-unstyled small">
                            <li><a href="#" class="filter-link" onclick="simulateFilter('price', 'low', event)">Sort:
                                    Price Low to High</a></li>
                            <li><a href="#" class="filter-link" onclick="simulateFilter('price', 'high', event)">Sort:
                                    Price High to Low</a></li>
                        </ul>
                    </div>

                    <button class="btn btn-primary-vibe btn-sm mt-3"
                        onclick="simulateFilter('reset', null, event)">Reset Filters</button>
                </div>
            </div>

            <div class="col-lg-9">
                <div class="row" id="product-grid">

                </div>
            </div>

        </div>
    </main>

    <div id="toast-notification" class="fixed-top alert d-none"
        style="top: 80px; right: 20px; width: 300px; z-index: 1000;">
        <i class="mr-2 fas"></i> <span></span>
    </div>

    <div id="chatbot-modal" class="chatbot-modal">
        <div class="chatbot-header">
            <span>AI Chatbot</span>
            <i class="fas fa-times chatbot-close" onclick="toggleChatbot()"></i>
        </div>
        <div class="chatbot-body">
            <div class="text-muted mb-2">Hello! How can I assist you?</div>

        </div>
        <div class="chatbot-input-area">
            <input type="text" placeholder="Type a message..." id="chatbot-input">
            <button onclick="simulateChatResponse()"><i class="fas fa-paper-plane"></i> Send</button>
        </div>
    </div>

    <div id="chatbot-icon" class="chatbot-float-icon" onclick="toggleChatbot()">
        <i class="fas fa-comment-dots"></i>
    </div>

    <footer class="footer-vibe mt-5">
        <div class="container py-4">
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>

    <script src="dropdown_search.js"></script>
    <script src="product.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const profileLink = document.querySelector('.fa-user-circle')?.parentElement;
            const loggedInCustomer = JSON.parse(localStorage.getItem('loggedInCustomer'));

            if (profileLink) {
                if (loggedInCustomer) {
                    // Logged in → go to profile page
                    profileLink.setAttribute('href', 'customer_profile.html');
                } else {
                    // Not logged in → go to login page
                    profileLink.setAttribute('href', 'login.html');
                }
            }
        });

        async function sendMessageToChatbot(message) {
            const loggedInCustomer = JSON.parse(localStorage.getItem("loggedInCustomer"));
            const customerId = loggedInCustomer ? loggedInCustomer.id : null;

            const response = await fetch("http://127.0.0.1:5000/chat", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ message: userMessage, customer_id: customerId })
            });
        }



    </script>

</body>

</html>